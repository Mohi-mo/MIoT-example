# MIoT-example
Упрощённый пример кода клиента с протоколом канального уровня DACAP

Это клиентская часть приложения, реализующего протокол DACAP (Data-Aided Carrier Access Protocol) для обмена текстовыми сообщениями между несколькими клиентами через сервер. Программа позволяет отправлять и получать сообщения, используя сетевые соединения (сокеты) на локальном компьютере. Она поддерживает отправку одиночных сообщений (например, test,1) или серии тестовых сообщений (msi,1) и логирует все действия для отладки. Протокол DACAP использует четыре типа сообщений: RTS (запрос на отправку), CTS (разрешение), INFO (само сообщение) и DELIVERED (подтверждение доставки).

Что делает приложение:

1) Подключается к серверу по указанному IP и порту.
2) Позволяет отправлять сообщения другому клиенту по его адресу.
3) Принимает входящие сообщения и выводит их на экран.
4) Записывает логи (журнал событий) для отслеживания работы.

# Сборка приложения
Чтобы собрать приложение, нужно скомпилировать исходные файлы в исполняемые программы для сервера и клиента.

Установите MinGW (если не установлен):
1) Скачайте MinGW с официального сайта или используйте пакетный менеджер (например, MSYS2).
2) Убедитесь, что gcc доступен в командной строке

Скомпилируйте проект клиента:
`gcc -o dacap_client.exe main.c dacap.c logger/logger.c -lws2_32`

Запустить приложение сервера EMU.exe или подключиться к коробочной версии.
Сервер начнёт случать порт 9200 и выведет сообщение:
`Server is listening on port 9200...`

Запустите клиентов через терминал windows. Каждый клиент - отдельный терминал.
Например, для запуска клиента 1, введите в терминал: './dacap_client.exe 127.0.0.1 9200'.
При успешном запуске, клиент будет подключён к серверу и вернёт информацию вида:
```
Client is active with node address 2!
Connected to server 127.0.0.2:9200
Input format: message,<address> or msi,<address> or exit 
```

# Использование приложения
Отправить одно сообщение:
`test,1` - отправляет сообщение "test" клиенту с гидроакустическим адресом 1.

Отправить 10 тестовых сообщений:
`msi,1` - отправляет сообщения от "Message 0" до "Message 1" клиенту с адресом 1.

Выход из приложения:
`exit`


# Что происходит?
Клиент отправляет RTS (запрос), ждёт CTS (разрешение) от получателя, отправляет INFO (сообщение) и получает DELIVERED (подтверждение).
Все действия записываются в лог (файл и консоль).

# Что получится? 
Сервер: Программа, которая принимает соединения от клиентов и передаёт сообщения между ними.
Клиент: Консольное приложение, где вы вводите команды для отправки сообщений и видите входящие сообщения.

Результат:

Вы можете отправлять сообщения между клиентами (например, от клиента 2 к клиенту 1).
Логи помогут понять, что происходит (например, какие сообщения отправлены или получены).
Программа устойчиво работает для одиночных и множественных отправок без зависаний (как подтверждено).
Пример работы:

Клиент 2 отправляет test,1:
Клиент 1 выводит: Message from 2: test.
Клиент 2 выводит: Message sent successfully.
Клиент 2 отправляет msi,1:
Клиент 1 получает 10 сообщений.
Клиент 2 подтверждает успех.

# Устранение проблем
_Ошибка компиляции:_ Убедитесь, что осуществляете сборку, находясь в директории с исходными файлами. 
Проверьте  правильность путей к файлам.

_Клиенты не соединяются:_
Убедитесь, что сервер запущен.
Проверьте IP и порт: 127.0.0.1 9200 и 127.0.0.2 9200.
Сообщения не доходят:
Проверьте логи в консоли или файле.
Консоль зависает: Это исправлено, но если возникнет, перезапустите клиентов и сервер.

# Дополнительно
_Логи:_ Ищите файлы логов (например, details_127.0.0.n.txt) или смотрите вывод в консоли для отладки.
_Сервер:_ Есть две реализации сервера - физическая виртуальная и виртуальная. Обе версии схожи, но есть различие в способа
